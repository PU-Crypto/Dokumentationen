<html lang="de">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<title>Dokumentation AES</title>
<style>
	body{
		font: 100% "Trebuchet MS", sans-serif;
		margin: 25px;
	}
</style>
</head>
<body>
<h1>Dokumentation AES</h1>

AES ist der Advanced Encryption Standard. Er wurde im Jahre 1997 vom NIST international in einem Wettbewerb ausgeschrieben, da der damals aktuelle Algorithmus DES, Data Encryption Standard, nur eine sehr geringe Länge der Schlüssel ermöglichte und durch ausprobieren effizienter gebrochen werden konnte, als durch mathematische Angriffsmethoden.
In diesem Wettbewerb wurden international Kryptologen aufgerufen ihre Vorschläge einzureichen, welche bestimmten Anforderungen entsprachen:
<ul>
	<li>AES sollte ein symmetrischer Algorithmus in Form einer Blockchiffre sein</li>
	<li>Die Länge der Blöcke wurde auf 128 Bit festgelegt</li>
	<li>Eine leichte Umsetzung in Hard- oder Software sollte gewährleistet sein</li>
	<li>Der Algorithmus sollte überdurchschnittliche Geschwindigkeitswerte liefern</li>
	<li>Es sollten keine damals bekannten Angriffsmethoden darauf anwendbar sein</li>
	<li>Er sollte geringere Anforderungen an die Hardware stellen, für Einsätze in z.B. Smartcards</li>
	<li>Es sollten keine patentlich geschützten Funktionen genutzt werden und später für jeden unentgeltlich zur Verfügung stehen</li>
</ul>
Nach zwei Konferenzen standen von 15 Einreichungen fünf Finalisten fest, die erneut international zur Kryptoanalyse ausgeschrieben wurden.<br>
Da alle bei der Sicherheit zu sehr ähnlichen Ergebnissen führten, hat man sich für den belgischen Algorithmus Rijndael (gesprochen:"raindahl") entschieden. Dieser wurde nach seinen Entwicklern Daemen und Rijmen genannt. Der Hauptgrund für diesen Algorithmus war die geringe Komplexität und herrausragenden Geschwindigkeit auf allen getesteten Plattformen.<br>
Nach einer erneuten Phase der Kryptoanalyse welche zu keinen Beanstandungen führte wurde Rijndael schließlich im Jahre 2000 durch das NIST zum Advanced Encryption Standard erklärt und ist seit dem für Verschlüsselungen bis zur höchsten Geheimhaltungsstufe in den USA zugelassen.<br>
Diese Art des offenen Wettbewerbs wurde international sehr positiv bewertet und wurde in der Kryptographie mehrfach wiederholt.

<h2>Funktionsweise von Rijndael</h2>
Der von Rijmen und Daemen entwickelte Algorithmus basiert auf mehreren Unterprozessen, die eine zweidimensionale Tabelle aus vier Zeilen und Spalten, Block genannt, mit einem Schlüssel verschlüsseln. Auch beim Schlüssel handelt es sich um eine zweidimensionale Tabelle. Dies findet in mehreren Durchläufen, sogenannten Runden, statt, deren Anzahl abhängig ist von der Länge des Schlüssels. Die Rundenzahl variiert zwischen 10 und 14 Durchläufen. Wichtig ist auch, dass Rijndael nicht für jede Runde den selben Schlüssel verwendet, sondern diesen zuvor in einem Verfahren erweitert und daher für jede Runde einen vom Hauptschlüssel abgeleiteten Rundenschlüssel verwendet.<br>
<b>Bedeutung des Schlüssels:</b><br>
Der Schlüssel ist nicht wie man erwarten könnte direkt das Passwort des Nutzers. Schon ein 128 Bit Schlüssel, was nicht mehr den aktuellen US-Sicherheitsanforderungen für die höchste Geheimhaltungsstufe entspricht, erfordert es sich 128 Binärzeichen zu merken. Das sind dann 32 Zeichen aus dem Hexadezimalsystem. Da diese Länge für Passwörter kaum praktikabel ist, wird der Schlüssel mithilfe spezifizierter Verfahren aus dem Passwort erweitert.

<h3>Ablauf von Rijndael</h3>
<ul>
	<li>Erweiterung des Schlüssels (Key Schedule)</li>
	<li>Vorrunde
		<ul>
			<li>Füge den ersten Rundenschlüssel hinzu (AddRoundKey)</li>
	</ul></li>
	<li>Vollständige Verschlüsselungsrunden
		<ul>
			<li>Übersetze in die S-Box (SubBytes)</li>
			<li>Verschiebe Werte innerhalb der Zeilen (ShiftRows)</li>
			<li>Verrechne die Zeilen mit einer Matrix (MixColumns)</li>
			<li>Füge den aktuellen Rundenschlüssel hinzu (AddRoundKey)</li>
	</ul></li>
	<li>Letzte Runde
		<ul>
			<li>SubBytes</li>
			<li>ShiftRows</li>
			<li>AddRoundKey</li>
	</ul></li>
</ul>

<h3>Die einzelnen Funktionen erläutert</h3>
<h4>Schlüsselerweiterung - KeySchedule</h4>
Bei der Schlüsselerweiterung wird für jede auszuführende Runde ein eigener Schlüssel erstellt. Dieser wird aus dem jeweils vorherigen abgeleitet. Der eigentliche Schlüssel kommt somit nur ein einziges mal im gesamten Algorithmus zum Einsatz.<br>
Der Ablauf ist in der ABBILDUNG _____ auch noch einmal grafisch dargestellt.<br>
Zunächst wird der Schlüssel als Block betrachtet. Um nun die nächste Spalte zu ermitteln wird zunächst die vorherige Spalte gewählt und der oberste Wert nach ganz unten geschrieben. Die anderen Werte Rücken anschließend nach. Darauf erfolgt der Einsatz der S-Box (siehe hierfür auch SubBytes), welche die Zeichen durch andere ersetzt. Abschließend wird diese Spalte mit der Spalte vier weiter links und einer Rundenkonstante (siehe _____) mit einem "Exklusiven Oder" (XOR) verknüpft.<br>
Eine XOR Verknüpfung findet auf binärer Ebene statt und ähnelt der schriftlichen Addition. Allerdings wird hier der Übertrag nicht beachtet.
<table border="1">
<caption>Beispiel für ein Exklusives Oder:</caption>
	<tr>
		<td>Wert A</td>
		<td>Wert B</td>
		<td>XOR</td>
	</tr>
	<tr>
		<td>0</td>
		<td>0</td>
		<td>0</td>
	</tr>
	<tr>
		<td>0</td>
		<td>1</td>
		<td>1</td>
	</tr>
	<tr>
		<td>1</td>
		<td>0</td>
		<td>1</td>
	</tr>
	<tr>
		<td>1</td>
		<td>1</td>
		<td>0</td>
	</tr>
</table>

Dieser umfangreiche Ablauf findet nur alle vier Durchgänge statt. Es handelt sich hier jeweils um die erste Spalte eines Rundenschlüssels.<br>
Die drei folgenden Schlüsselerweiterungen  sind weniger umfangreich. Hier wird nur die vorherige Spalte und die Spalte vier vorher in einer XOR Verknüpfung zusammengeführt.<br>
Wie oft dieser Prozess durchläuft ist abhängig von der Länge des Schlüssels und damit der Anzahl der Runden. Für jede Runde wird ein Schlüssel benötigt.

<h4>Die Addition des Rundenschlüssels - AddRoundKey</h4>
In diesem Schritt wird der zu verschlüsselnde Block mit dem aktuellen Rundenschlüssel, welcher ebenfalls als ein Block betrachtet werden kann, XOR verknüpft.
Dies bedeutet, dass der erste Wert aus der ersten Spalte des Blocks mit dem ersten Wert aus der ersten Spalte des Keys verknüpft wird. Der zweite dann mit dem zweiten usw.
Nur in diesem Schritt kommt der Schlüssel des Nutzers zum Einsatz.

<h4>Die Übersetzung in die S-Box - SubBytes</h4>
Ein jeder Wert im Block wird durch einen zugehörigen Wert aus der S-Box ersetzt. Bei diesem Arbeitsschritt handelt es sich um eine Form der monoalphabetischen Verschlüsselung. Diese ist vergleichbar mit dem verwenden eines Alphabets, wo ein Buchstabe durch einen anderen aus diesem ersetzt wurde. Das Ergebnis kann nur der Empfänger lesen, der die Veränderung der Buchstaben kennt. Allerdings ist hier die S-Box öffentlich.<br>
<b>Die S-Box:</b><br>
Bei der S-Box handelt es sich um eine Tabelle, wo jedem Paar von Hexadezimalwerten ein anderes Paar zugewiesen wird. Sie ist eine Grundkomponente symmetrischer Verschlüsselungsverfahren.
In jedem Algorithmus kommen eigene, zum Teil mehrere, S-Boxen zum Einsatz. Der Vorgänger von AES, der Data Encryption Standard, benötigte 8 S-Boxen. Die von Rijndael benötigte S-Box wurde mithilfe von Matrixmultiplikationen über einem besonderen endlichen Körper ermittelt und anschließend anhand bestimmter Sicherhietsanforderungen getestet.

<h4>Die Verschiebung von Werten innerhalb der Zeilen - ShiftRows</h4>
Bei ShiftRows werden die einzelnen Werte innerhalb einer Zeile nach hinten verschoben. Die anderen Werte rücken dementsprechend nach. Die Anzahl der Verschiebungen hängt von der Zeile und von der Schlüssellänge ab.
<table border="1">
	<tr>
		<td>Zeile</td>
		<td>Verschiebung</td>
	</tr>
	<tr>
		<td>Zeile 1:</td>
		<td>0</td>
	</tr>
	<tr>
		<td>Zeile 2:</td>
		<td>1</td>
	</tr>
	<tr>
		<td>Zeile 3:</td>
		<td>2</td>
	</tr>
	<tr>
		<td>Zeile 4:</td>
		<td>3</td>
	</tr>
</table>

<br>
<h4>Die Vermischung der Spalten - MixColumns</h4>



<h2>Kryptoanalyse von AES</h2>
Wie eingangs erwähnt wurde bereits beim Auswahlverfahren Rijndael international zur Kryptoanalyse ausgeschrieben und war gegen damals bekannte Verfahren abgesichert. Durch die Möglichkeit sehr lange Schlüssel zu verwenden ist es auch durch ausprobieren von Schlüsseln nicht effizient möglich Rijndael zu brechen.<br>
Erst im Jahr 2001 ist es den Forschern Niels Ferguson, Richard Schroeppel und Doug Whiting gelungen einen theoretischen Angriff auf Rijndael zu entwerfen. Dies gelang ihnen dadurch, dass sie den Algorithmus in eine Formel schrieben, welche aus mehreren verketteten Brüchen bestehen, wie in ABBILDUNG ___ dargestellt. Eine praktische Relevanz hat diese Erkenntnis jedoch bislang nicht.<br>
Ein weiterer Angriff ist 2005 von Daniel J. Bernstein vorgestellt worden. Diesem gelang es mithilfe von bekannten Texten die er verschlüsselte und dem Messen der Zeiten für die Verschlüsselung den Schlüssel zu ermitteln. Dies liegt daran, dass die Umwandlungen, wie die S-Box und die MixColumns Tabellen, zur Optimierung in Tabellen gespeichert sind und daher über die verbrauchte Zeit Rückschlüsse auf den verwendeten Schlüssel möglich sind. Ob dieses Szenario in der Praxis funktioniert ist jedoch äußerst umstritten.<br>
Im Jahr 2009 stellten Alex Biryukov and Dmitry Khovratovich einen weiteren theretischen Angriff auf Rijndael, der die benötigte Menge an auszuprobierenden Schlüsseln reduzierte. Bei der Anwendung eines Schlüssels von 256 Bit wäre der Schlüsselpool 2<sup>256</sup> durch diese Angriffsmethode auf 2<sup>119</sup> und später auf 2<sup>99,5</sup> reduzieren. Dies bedeutet, dass Rijndael nun in der Theorie gebrochen ist. Allerdings liegt ein durchprobieren von 2<sup>99,5</sup> möglichen Kombinationen noch immer weit jenseits eines positiven Kosten-Nutzen-Verhältnisses für einen Angreifer, was ja das Ziel jeder Sicherheitmaßnahme ist.
Dies sagte auch Bruce Schneier, als er diesen Angriff veröffentlichte: <br>
<i>"While this attack is better than brute force -- and some cryptographers will describe the algorithm as "broken" because of it -- it is still far, far beyond our capabilities of computation. The attack is, and probably forever will be, theoretical. But remember: attacks always get better, they never get worse. Others will continue to improve on these numbers. While there's no reason to panic, no reason to stop using AES, no reason to insist that NIST choose another encryption standard[...]"</i><br>
Aus: https://www.schneier.com/blog/archives/2009/07/new_attack_on_a.html

</body>
</html>